<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.110.0">
    <meta name="description" content="">


    <link rel="icon" href="//svenvdl-npo.github.io/player-docs/images/favicon.png" type="image/png">

    <title>Create JSON Web Token (JWT) :: NPO Player documentation</title>

    
    <link href="//svenvdl-npo.github.io/player-docs/css/nucleus.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/fontawesome-all.min.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/hybrid.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/featherlight.min.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/perfect-scrollbar.min.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/auto-complete.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/atom-one-dark-reasonable.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/theme.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/tabs.css?1676460228" rel="stylesheet">
    <link href="//svenvdl-npo.github.io/player-docs/css/hugo-theme.css?1676460228" rel="stylesheet">
    
    <link href="//svenvdl-npo.github.io/player-docs/css/theme-npo.css?1676460228" rel="stylesheet">
    
    

    <script src="//svenvdl-npo.github.io/player-docs/js/jquery-3.3.1.min.js?1676460228"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="//svenvdl-npo.github.io/player-docs/implementation/create-a-jwt/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 275 187.5" style="enable-background:new 0 0 275 187.5;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#E5E5E5;}
	.st1{fill:#FD6B00;}
	.st2{fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;}
</style>
<g id="svg2" inkscape:version="0.48.3.1 r9886" sodipodi:docname="Neues Dokument 1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:svg="http://www.w3.org/2000/svg">
	<g id="layer1" transform="translate(-267.90319,-401.477)" inkscape:groupmode="layer" inkscape:label="Ebene 1">
		<g>
			<path id="path3005" inkscape:connector-curvature="0" class="st0" d="M445,506.6l-71.9,71.9c-7.2,7.2-15.6,7.2-22.8,0l-71.9-71.9
				c-7.2-7.2-7.2-15.5,0-22.8l71.9-71.9c7.2-7.3,15.5-7.3,22.8,0l71.9,71.9C452.3,491.1,452.3,499.4,445,506.6"/>
		</g>
		<g>
			<path id="path3013" inkscape:connector-curvature="0" class="st1" d="M365.8,483.8c-7.2,7.2-7.2,15.5,0,22.8l71.9,71.9
				c7.2,7.2,15.5,7.2,22.8,0l71.9-71.9c7.2-7.2,7.2-15.5,0-22.8l-71.9-71.9c-7.2-7.2-15.6-7.2-22.8,0L365.8,483.8z"/>
		</g>
	</g>
</g>
<g id="Layer_2">
	<path class="st2" d="M157.5,58.5c0-5.9,4.2-11.3,10.1-11.3c2,0,3.8,0.6,5.5,1.8l45.1,32.2c4.7,3.4,6,10.3,3.2,15.4
		c-0.8,1.5-1.9,2.8-3.2,3.7l-45.1,32.2c-4.9,3.5-11.3,1.6-14.2-3.7c-1-1.8-1.4-3.8-1.4-5.8V58.5z"/>
</g>
<g id="Layer_3">
	<g>
		<path d="M42.9,113.9L26.5,97.5c-0.8-0.8-0.9-1.7-0.4-2.7c0.7-1.4,1.9-2.9,3.7-4.7c2.5-2.5,5.1-3.8,7.7-3.8s5.1,1.1,7.4,3.4
			s3.5,4.8,3.5,7.4c0,2.6-1.1,5.1-3.3,7.4c-0.9,0.9-1.8,1.6-2.7,2.1l3.9,3.9c0.4,0.4,0.6,0.8,0.7,1.2c0,0.4-0.2,0.8-0.7,1.2
			l-0.9,0.9c-0.4,0.4-0.8,0.7-1.2,0.7C43.8,114.5,43.4,114.3,42.9,113.9z M31.1,95.2l8.5,8.5c0.8-0.4,1.5-1,2.3-1.7
			c1.4-1.4,2.1-2.9,2-4.4s-0.9-3-2.3-4.4c-1.4-1.4-2.9-2.2-4.4-2.3c-1.5-0.1-3,0.6-4.4,2C32,93.7,31.5,94.5,31.1,95.2z"/>
		<path d="M53.9,92.8L36.3,75.2c-0.4-0.4-0.7-0.8-0.7-1.2c0-0.4,0.2-0.8,0.7-1.2l0.9-0.9c0.4-0.4,0.8-0.7,1.2-0.7
			c0.4,0,0.8,0.2,1.2,0.7l17.6,17.6c0.4,0.4,0.7,0.8,0.7,1.2c0,0.4-0.2,0.8-0.7,1.2l-0.9,0.9c-0.4,0.4-0.8,0.7-1.2,0.7
			C54.7,93.4,54.3,93.2,53.9,92.8z"/>
		<path d="M50.7,74.4l-0.4-0.2c-0.3-0.1-0.5-0.3-0.7-0.5c-0.4-0.4-0.5-1-0.2-1.8c0.6-1.5,1.9-3.3,3.8-5.2c2-2,4-3,5.9-3.1
			c1.9,0,3.9,1,6,3l7,7c0.5,0.5,0.7,0.9,0.7,1.3c0,0.4-0.2,0.9-0.5,1.4c-1,1.7-2.5,3.5-4.5,5.5c-2,2-4,3.2-5.8,3.5
			c-1.9,0.3-3.6-0.3-5.1-1.8c-1.5-1.5-2.1-3.2-1.8-5.1s1.4-3.7,3.3-5.6c1.1-1.1,2.2-2,3.4-2.7l-0.4-0.4c-1.8-1.8-3.8-1.7-5.9,0.4
			c-0.8,0.8-1.6,1.9-2.3,3.3c-0.2,0.4-0.4,0.7-0.5,0.8C52.1,74.7,51.5,74.7,50.7,74.4z M67.8,76.3l-3.6-3.6
			c-0.9,0.5-1.8,1.2-2.7,2.1c-2.2,2.2-2.6,4-1.2,5.5c1.4,1.4,3.2,1,5.5-1.3C66.7,78,67.4,77.1,67.8,76.3z"/>
		<path d="M85.9,73.4L85,74.3c-0.7,0.7-1.3,0.7-1.9,0.2c-0.2-0.2-0.4-0.5-0.6-1l-2.4-5.5l-16.9-7.6c-0.5-0.2-0.8-0.4-1-0.6
			c-0.6-0.6-0.5-1.2,0.2-1.9l1.2-1.2c0.8-0.8,1.7-0.9,2.7-0.3l12.2,6.3l-6.3-12.2c-0.5-1.1-0.4-2,0.3-2.7l1.1-1.1
			c0.7-0.7,1.3-0.7,1.9-0.2c0.2,0.2,0.4,0.5,0.6,1l10.2,23c0.3,0.6,0.4,1.1,0.3,1.5C86.6,72.5,86.4,73,85.9,73.4z"/>
		<path d="M100.3,44.1l0.5,0.2c0.3,0.2,0.6,0.3,0.8,0.5c0.5,0.5,0.6,1.1,0.2,1.9c-0.7,1.6-1.9,3.2-3.6,4.9c-2.5,2.5-4.9,3.7-7.5,3.6
			c-2.5,0-5-1.2-7.4-3.6c-2.5-2.5-3.7-5-3.7-7.5c0-2.5,1-4.7,2.9-6.7c2-2,4.3-3,6.7-2.9s4.8,1.3,7.1,3.6c0.8,0.8,0.8,1.5,0.1,2.1
			l-8.8,8.8c1.1,1.1,2.4,1.6,3.7,1.5c1.4-0.1,2.8-0.8,4.3-2.3c0.9-0.9,1.6-2,2.3-3.3c0.2-0.4,0.4-0.6,0.5-0.8
			C98.8,43.8,99.5,43.7,100.3,44.1z M85.2,46.7l6.4-6.4c-1.2-1-2.3-1.6-3.5-1.6s-2.2,0.4-3.2,1.4s-1.4,2-1.3,3.2
			C83.7,44.3,84.2,45.5,85.2,46.7z"/>
		<path d="M105.2,41.5L94,30.3c-0.8-0.8-0.9-1.7-0.4-2.7c1.1-1.9,2.3-3.6,3.8-5.1c0.8-0.8,1.5-1.4,2.1-1.9c0.8-0.6,1.5-0.6,2.2,0
			c0.2,0.2,0.3,0.4,0.5,0.6l0.2,0.3c0.3,0.5,0.5,0.9,0.5,1.2s-0.1,0.6-0.5,1c-0.1,0.1-0.4,0.3-0.8,0.7s-0.9,0.7-1.2,1
			c-0.9,0.9-1.6,1.8-2,2.6l10,10c0.4,0.4,0.6,0.8,0.6,1.2c0,0.4-0.2,0.8-0.7,1.2l-0.9,0.9c-0.4,0.4-0.8,0.7-1.2,0.7
			C106,42.1,105.6,41.9,105.2,41.5z"/>
	</g>
</g>
</svg>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="//svenvdl-npo.github.io/player-docs/js/lunr.min.js?1676460228"></script>
<script type="text/javascript" src="//svenvdl-npo.github.io/player-docs/js/auto-complete.js?1676460228"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/svenvdl-npo.github.io\/player-docs";
    
</script>
<script type="text/javascript" src="//svenvdl-npo.github.io/player-docs/js/search.js?1676460228"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='//svenvdl-npo.github.io/player-docs/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/implementation/" title="Implementation" class="dd-item
        parent
        
        
        ">
      <a href="//svenvdl-npo.github.io/player-docs/implementation/">
          Implementation
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/implementation/getting-started/" title="Getting started" class="dd-item
        
        
        
        ">
      <a href="//svenvdl-npo.github.io/player-docs/implementation/getting-started/">
          <b>1. </b>Getting started
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/implementation/create-a-jwt/" title="Create JSON Web Token (JWT)" class="dd-item
        
        active
        
        ">
      <a href="//svenvdl-npo.github.io/player-docs/implementation/create-a-jwt/">
          <b>2. </b>Create JSON Web Token (JWT)
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/implementation/android/" title="Implementation on Android" class="dd-item
        
        
        
        ">
      <a href="//svenvdl-npo.github.io/player-docs/implementation/android/">
          <b>3. </b>Implementation on Android
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/implementation/web/" title="Implementation for Web" class="dd-item
        
        
        
        ">
      <a href="//svenvdl-npo.github.io/player-docs/implementation/web/">
          <b>4. </b>Implementation for Web
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/implementation/web/npm/" title="Implementation via NPM" class="dd-item
        
        
        
        ">
      <a href="//svenvdl-npo.github.io/player-docs/implementation/web/npm/">
          <b>a. </b>Implementation via NPM
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/implementation/web/cdn/" title="Implementation via CDN" class="dd-item
        
        
        
        ">
      <a href="//svenvdl-npo.github.io/player-docs/implementation/web/cdn/">
          <b>b. </b>Implementation via CDN
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='//svenvdl-npo.github.io/player-docs/'>Welcome</a> > <a href='//svenvdl-npo.github.io/player-docs/implementation/'>Implementation</a> > Create JSON Web Token (JWT)
          
        
          
        
          
        
                 
                  </span>
                </div>
                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
          <div id="chapter">
        
        <div id="body-inner">
          

        



	<p>JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed. JWTs can be signed using a secret (with the HMAC algorithm) or a public/private key pair using RSA or ECDSA.</p>
<p>Although JWTs can be encrypted to also provide secrecy between parties, we will focus on signed tokens. Signed tokens can verify the integrity of the claims contained within it, while encrypted tokens hide those claims from other parties. When tokens are signed using public/private key pairs, the signature also certifies that only the party holding the private key is the one that signed it.</p>
<h1 id="what-is-the-json-web-token-structure">What is the JSON Web Token structure?</h1>
<p>In its compact form, JSON Web Tokens consist of three parts separated by dots (.), which are:</p>
<ul>
<li>Header</li>
<li>Payload</li>
<li>Signature</li>
</ul>
<p>Therefore, a JWT typically looks like the following.</p>
<pre tabindex="0"><code>xxxxx.yyyyy.zzzzz
</code></pre><h1 id="why-do-we-use-it">Why do we use it?</h1>
<p>Why do we need to implement a JWT? Here are two cases why we decided to use the token.</p>
<ul>
<li>
<p><strong>Authorization</strong>: This is the most common scenario for using JWT. Once the user is logged in, each subsequent request will include the JWT, allowing the user to access routes, services, and resources that are permitted with that token. Single Sign On is a feature that widely uses JWT nowadays, because of its small overhead and its ability to be easily used across different domains.</p>
</li>
<li>
<p><strong>Information Exchange</strong>: JSON Web Tokens are a good way of securely transmitting information between parties. Because JWTs can be signed—for example, using public/private key pairs—you can be sure the senders are who they say they are. Additionally, as the signature is calculated using the header and the payload, you can also verify that the content hasn&rsquo;t been tampered with.</p>
</li>
</ul>
<h1 id="make-it-secure">Make it secure…!</h1>
<p>Please make <strong>sure</strong> you are creating this JWT server sided. With <strong>no deep link possibility</strong>. When made public every person on the internet could use this implementation to get <strong>access</strong> to the media content of NPO. This will result in a <strong>NDA breach</strong>. What could result in a <strong>law suit</strong>. So please be <strong>cautious</strong> with your secrets</p>
<ul>
<li>Tips for implementering securely:</li>
<li>Use origin whitelisting.
<ul>
<li>Domain whitlisting</li>
<li>IP whitlisting</li>
</ul>
</li>
<li>Create token only server sided.</li>
<li>Keep secret out of sight.</li>
</ul>
<p>When a breach has occurred please notify the NPO player team and request a new secret.</p>
<h1 id="setting-up-jwt-with-javascript--node">Setting up JWT with JavaScript / Node</h1>
<p><a href="https://www.npmjs.com/package/jsonwebtoken">See here how to implement the JWT with JavaScript</a></p>
<p>We use the npm: jsonwebtoken package for creating a signed JWT. But feel free to use other packages that can do the same.</p>
<h2 id="install">Install</h2>
<pre tabindex="0"><code>$ npm install jsonwebtoken
</code></pre><h2 id="usage">Usage</h2>
<p>lets make a var with access to the <code>jsonwebtoken</code> package.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jwt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;jsonwebtoken&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jwtSecret</span> <span style="color:#f92672">=</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#a6e22e">YOUR</span> <span style="color:#a6e22e">SECRET</span> <span style="color:#a6e22e">TO</span> <span style="color:#a6e22e">SIGN</span> <span style="color:#a6e22e">THE</span> <span style="color:#a6e22e">JWT</span> <span style="color:#f92672">&gt;&gt;</span>;
</span></span></code></pre></div><p>Now we create the payload for the JWT.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">payload</span>.<span style="color:#a6e22e">iat</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">floor</span>(Date.<span style="color:#a6e22e">now</span>() <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">payload</span>.<span style="color:#a6e22e">sub</span> <span style="color:#f92672">=</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#a6e22e">PRID</span> <span style="color:#f92672">&gt;&gt;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">payload</span>.<span style="color:#a6e22e">iss</span> <span style="color:#f92672">=</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#a6e22e">YOUR</span> <span style="color:#a6e22e">BROADCASTER</span> <span style="color:#a6e22e">NAME</span> <span style="color:#f92672">&gt;&gt;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">payload</span>.<span style="color:#a6e22e">cip</span> <span style="color:#f92672">=</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#a6e22e">CLIENT</span> <span style="color:#a6e22e">IP</span> <span style="color:#f92672">&gt;&gt;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">payload</span>.<span style="color:#a6e22e">age</span> <span style="color:#f92672">=</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#a6e22e">AGE</span> <span style="color:#a6e22e">OF</span> <span style="color:#a6e22e">CLIENT</span> (<span style="color:#a6e22e">optional</span>) <span style="color:#f92672">&gt;&gt;</span>;
</span></span></code></pre></div><p>The payload is created and needs to be signed by a secret</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">jwtToken</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">sign</span>(<span style="color:#a6e22e">payload</span>, <span style="color:#a6e22e">jwtSecret</span>);
</span></span></code></pre></div><p>The <code>jwtToken</code> has the token declared and is ready to be used in the NPO player intergration documentation</p>
<h1 id="setting-up-jwt-with-php--wordpress">Setting up JWT with PHP / WordPress</h1>
<p>Always generate a token server sided. To do this we have created a function.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * @param array $payload
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * @param string $secret
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * @return string
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createJsonWebToken</span>(<span style="color:#66d9ef">array</span> $payload, <span style="color:#a6e22e">string</span> $secret) <span style="color:#f92672">:</span> <span style="color:#a6e22e">string</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create token header as a JSON string
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    $header <span style="color:#f92672">=</span> <span style="color:#a6e22e">json_encode</span>([<span style="color:#e6db74">&#39;typ&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;JWT&#39;</span>, <span style="color:#e6db74">&#39;alg&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;HS256&#39;</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Encode Header to Base64Url String
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    $base64UrlHeader <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>([<span style="color:#e6db74">&#39;+&#39;</span>, <span style="color:#e6db74">&#39;/&#39;</span>, <span style="color:#e6db74">&#39;=&#39;</span>], [<span style="color:#e6db74">&#39;-&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>], <span style="color:#a6e22e">base64_encode</span>($header));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create token payload as a JSON string
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    $payload <span style="color:#f92672">=</span> <span style="color:#a6e22e">json_encode</span>($payload);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Encode Payload to Base64Url String
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    $base64UrlPayload <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>([<span style="color:#e6db74">&#39;+&#39;</span>, <span style="color:#e6db74">&#39;/&#39;</span>, <span style="color:#e6db74">&#39;=&#39;</span>], [<span style="color:#e6db74">&#39;-&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>], <span style="color:#a6e22e">base64_encode</span>($payload));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create Signature Hash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    $signature <span style="color:#f92672">=</span> <span style="color:#a6e22e">hash_hmac</span>(<span style="color:#e6db74">&#39;sha256&#39;</span>, $base64UrlHeader <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">.</span> $base64UrlPayload, $secret, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Encode Signature to Base64Url String
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    $base64UrlSignature <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>([<span style="color:#e6db74">&#39;+&#39;</span>, <span style="color:#e6db74">&#39;/&#39;</span>, <span style="color:#e6db74">&#39;=&#39;</span>], [<span style="color:#e6db74">&#39;-&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>], <span style="color:#a6e22e">base64_encode</span>($signature));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $base64UrlHeader <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">.</span> $base64UrlPayload <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">.</span> $base64UrlSignature;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this function you put the payload as array and you provide the secret.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$payload <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;iat&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">time</span>(), <span style="color:#75715e">// current timestamp
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;sub&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;AT_300002877&#39;</span>, <span style="color:#75715e">// prid of mid
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;iss&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;&lt;&lt; BROADCASTER NAME &gt;&gt;&#39;</span>, <span style="color:#75715e">// broadcaster name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;cip&#39;</span> <span style="color:#f92672">=&gt;</span> $_SERVER[<span style="color:#e6db74">&#39;REMOTE_ADDR&#39;</span>], <span style="color:#75715e">// ip of client
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;age&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">22</span> <span style="color:#75715e">// age for age restricted content
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>];
</span></span></code></pre></div>




<footer class=" footline" >
	
</footer>

        
            </div> 
        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="//svenvdl-npo.github.io/player-docs/implementation/getting-started/" title="Getting started"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="//svenvdl-npo.github.io/player-docs/implementation/android/" title="Implementation on Android" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="//svenvdl-npo.github.io/player-docs/js/clipboard.min.js?1676460228"></script>
    <script src="//svenvdl-npo.github.io/player-docs/js/perfect-scrollbar.min.js?1676460228"></script>
    <script src="//svenvdl-npo.github.io/player-docs/js/perfect-scrollbar.jquery.min.js?1676460228"></script>
    <script src="//svenvdl-npo.github.io/player-docs/js/jquery.sticky.js?1676460228"></script>
    <script src="//svenvdl-npo.github.io/player-docs/js/featherlight.min.js?1676460228"></script>
    <script src="//svenvdl-npo.github.io/player-docs/js/highlight.pack.js?1676460228"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="//svenvdl-npo.github.io/player-docs/js/modernizr.custom-3.6.0.js?1676460228"></script>
    <script src="//svenvdl-npo.github.io/player-docs/js/learn.js?1676460228"></script>
    <script src="//svenvdl-npo.github.io/player-docs/js/hugo-learn.js?1676460228"></script>
    
        
            <script src="//svenvdl-npo.github.io/player-docs/mermaid/mermaid.js?1676460228"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
